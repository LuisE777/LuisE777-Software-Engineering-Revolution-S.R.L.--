<div>
  <app-navbar>
  </app-navbar>
</div>
<aside class="sidebar" >
  <app-accordion ></app-accordion>
</aside>
<!-- finish -->

<div class="sidecontent">

  <div  style=" margin: auto; width: 98%">
    <h1 class="Titulo" >Generar nueva solicitud de compra</h1>
   
    <div style=" display: flex; flex-direction: row; align-items: center">
     <!-- <p>{{this.recivedName.nombreItem}}</p> -->
      <div  >
        <form [formGroup]="form">  
          <mat-form-field style="width: 350px;" appearance="fill">
            <mat-label>Seleccione algun item superior para generar una solicitud</mat-label>
            <mat-select id="itemsuperiorselect" matNativeControl [formControl]="carControl" name="car" (selectionChange)="onSelectChange($event)">
              <mat-option value="">Ninguno</mat-option>
              <mat-option id="itemcargados" *ngFor="let car of itemSup" [value]="car.nomitemSup">
                {{car.nomitemSup}}
              </mat-option>
            </mat-select>

            <mat-error *ngIf="carControl.hasError('required')">Por favor, seleccione un item superior</mat-error>
            <mat-hint>Esta solicitud sera del tipo: {{carControl.value}}</mat-hint>


          </mat-form-field>      
        </form>
      </div>       
     
      <!--      <p style=" margin: 10px">Esta solicitud sera del tipo: {{carControl.value}}</p> -->

     
    </div>
  
  <div style="width: 90%;">
      
      <button id="agregaritem" style="float: right;" mat-raised-button (click)="abrirDialogo()"  [disabled]="!carControl.value">Agregar item</button>
  
    </div>
    
    <table mat-table [dataSource]="ds" class="mat-elevation-z8" #tabla1 style="width: 90%;margin-bottom: 1rem;">
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef> Código </th>
        <td mat-cell *matCellDef="let item"> {{item.item_id}} </td>
      </ng-container>
  
      <ng-container matColumnDef="nombre">
        <th mat-header-cell *matHeaderCellDef> Nombre </th>
        <td mat-cell *matCellDef="let item"> {{item.nombre}} </td>
      </ng-container>
      <ng-container matColumnDef="descrip">
        <th mat-header-cell *matHeaderCellDef> Descripción </th>
        <td mat-cell *matCellDef="let item"> {{item.descrip}} </td>
      </ng-container>
  
      <ng-container matColumnDef="cantidad">
        <!-- This ones defines the columns-->
        <th mat-header-cell *matHeaderCellDef> Cantidad </th>
        <td mat-cell *matCellDef="let item"> {{item.cantidad}} </td>
      </ng-container>
  
      <ng-container matColumnDef="precio">
        <th mat-header-cell *matHeaderCellDef> Precio </th>
        <td mat-cell *matCellDef="let item"> {{item.precio}} </td>
      </ng-container>
  
      <ng-container matColumnDef="borrar">
        <th mat-header-cell *matHeaderCellDef> Eliminar </th>
        <td mat-cell *matCellDef="let j = index;">
          <!-- -->
  
          <!--  
              <button mat-icon-button color="warn" (click)="startEdit(j)">
               Editar
          </button>
            -->
  
          <button mat-raised-button color="warn" focusable="false" (click)="borrarFila(j)">
            Eliminar
          </button>
        </td>
      </ng-container>
  
      <tr mat-header-row *matHeaderRowDef="columnas"></tr>
      <tr mat-row *matRowDef="let row; columns: columnas;"></tr>
    </table>
    <div *ngIf="supera > 0" >
      <mat-hint  >El monto asignado por su unidad, para este item superior es de: {{supera}}</mat-hint>
      <br>
      <mat-hint> Si este monto es superado. Su solicitud tiene mas probabilidad de ser rechazada </mat-hint>
      
    </div>
   
  
    <button id="enviarsolicitud" mat-raised-button color="primary" type="submit" (click)="enviarSolicitud()">Guardar solicitud</button>
    <button  style=" margin-left: 5px;background-color: #9b9b9b;" mat-flat-button color="primary" type="submit" (click)="cancelar()">Cancelar</button>
  </div>
</div>
